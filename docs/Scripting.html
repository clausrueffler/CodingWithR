<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Learning Coding in R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Population and community ecology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learning Coding in R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./TheConsole.html">R as an oversized calculator: The Console</a>
    </li>
    <li>
      <a href="./Scripting.html">Programming in R</a>
    </li>
    <li>
      <a href="./Plots.html">Basic Plotting</a>
    </li>
    <li>
      <a href="./Markdown.html">Documenting Code</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="programming-in-r" class="section level1 tabset">
<h1>Programming in R</h1>
<div id="computing-using-scripts" class="section level2">
<h2>Computing Using Scripts</h2>
<p>Now that we are more familiar with the basics of R, we turn to writing programs. Typically, you will write more complex programs in a text file (called a script), with extension <code>.R</code>. Before writing our first programs, this section will demonstrate how to organize your code to make it readable and easy to understand.</p>
<div id="why-write-a-script" class="section level3">
<h3>Why Write a Script?</h3>
<p>You could actually accomplish almost everything you need for your research without writing any scripts — simply type the commands in the console one at a time. However, by organizing your work into well-documented scripts, you can</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>recycle</td>
<td>You will encounter similar problems in the future, and, having a script, you will be almost done before you even start.</td>
</tr>
<tr class="even">
<td>automate</td>
<td>You will need to repeat the analysis on a different data set, or slightly tweak it in response to comments. This will be quick if you have a script, while repeating the analysis from scratch would take considerably longer (not to mention the possibility of making mistakes).</td>
</tr>
<tr class="odd">
<td>document</td>
<td>By organizing your code in a script, you will know exactly what you did to obtain your results. You will much appreciate this precise documentation when you write the “Methods” section of your paper or thesis. More on documenting code later.</td>
</tr>
<tr class="even">
<td>share</td>
<td>Having a script makes it much easier to share your analysis with other scientists. You can ask your coauthors to examine your code for errors before you publish and eventually share it with other scientists who want to conduct their analysis exactly as described in your “Methods” section.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="writing-good-code" class="section level2">
<h2>Writing Good Code</h2>
<p>Before we start writing scripts, we have a few suggestions on how to organize and format your code:</p>
<div id="names" class="section level5">
<h5>Names</h5>
<p>Use descriptive file names for your scripts; use underscore (_) to separate words.</p>
<p>Likewise, choose informative names for your objects and functions:</p>
<pre><code># good object names (use nouns!)
my_variance 
radius
body_mass
# bad object names
tmp5
foo
good</code></pre>
<p>To avoid confusion, never call your objects</p>
<pre><code>I # uppercase i
O # uppercase o
o # lowercase O
l # lowercase L</code></pre>
<p>Good function names (use verbs!)</p>
<pre><code>calculate_cv
random_time_series</code></pre>
<p>Bad (i.e., uninformative) function names are</p>
<pre><code>f1
faster_version
this_works_well</code></pre>
</div>
<div id="spacing-and-parentheses" class="section level5">
<h5>Spacing and Parentheses</h5>
<p>Put a space before and after an operator (the only exception is a colon), and before a left parenthesis (function arguments are the only exception). Add a space after each comma, but not before. A white line separates functions. Use parentheses to make complex calculations easier to understand.</p>
<pre class="r"><code># good
x &lt;- 5 * 7
y &lt;- 7 * (x ^ 2)
m &lt;- matrix(25, 5, 5)
z &lt;- mean(x, na.rm == TRUE) i &lt;- t + 1
z &lt;- (x * y) + (x2 * y2)

if (b == 5) {
  do(something)
} else {
  do(something_else)
}

# bad
z = &quot;bad_assignment_style&quot;
x&lt;-5*7
y &lt;- 7*x^2
m &lt;- matrix(25 , 5 , 5)</code></pre>
</div>
</div>
<div id="loops" class="section level2">
<h2>Loops</h2>
<p>Another way to modify the flow of a program is to write a loop. A loop is a series of commands that are repeated a number of times. For example, you want to run the same analysis on different data sets that you have collected, or you want to plot the results contained in a set of files, or you want to test your simulation over a number of parameter sets, etc.</p>
<p>R provides you with two ways to loop over blocks of commands: the <code>for</code> loop, and the <code>while</code> loop. Let’s start with the for loop, which is used to iterate over a vector (or a list): for each value of the vector, a series of commands will be run, as shown by the following example:</p>
<pre class="r"><code>myvec &lt;- 1:10 # vector with numbers from 1 to 10
for (i in myvec) {
  a &lt;- i ^ 2
  print(a)
}</code></pre>
<p>In the code above, the variable <code>i</code> takes the value of each element of <code>myvec</code> in sequence. Inside the block defined by the for loop, you can use the variable <code>i</code> to perform operations. Note that <code>i</code> is only an example of a variable name. Note also that in this <code>for</code> loop each new command starts on a new line. This is essential! the same applies to the other looping constructions and to functions.</p>
<p>This is the anatomy of a <code>for</code> statement:</p>
<pre><code>for (variable in list_or_vector) {
  execute these commands # if there is more than one command each has to start on a new line</code></pre>
<p>A <code>for</code> loop is used when you know that you want to perform the analysis using a given set of values (e.g., run over for a fixed number of iterations).</p>
<p>The <code>while</code> loop is used when the commands need to be repeated while a certain condition is true, as shown by the following example:</p>
<pre class="r"><code>i &lt;- 1
while (i &lt;= 10) {
  a &lt;- i ^ 2
  print(a)
  i &lt;- i + 1
}</code></pre>
<p>This script performs exactly the same operations we wrote for the <code>for</code> loop above. Note that you need to update the value of <code>i</code> (using <code>i &lt;- i + 1</code>), otherwise the loop will run forever (infinite loop — to terminate click on the “Stop” button in the top-right corner of RStudio). The anatomy of the while statement is</p>
<pre><code>while (condition is TRUE) {
  execute these commands update the condition
}</code></pre>
<p>and the corresponding flow chart is</p>
<p><img src="images/WhileLoop.png" width="30%" /></p>
<p>You can exit a loop by using the command break in an <code>if</code>-construction. For example,</p>
<pre class="r"><code>i &lt;- 1

while (i &lt;= 10) {
  if (i &gt; 5) {
    break
  }
  a &lt;- i ^ 2
  print(a)
  i &lt;- i + 1
}</code></pre>
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<p>What does this codes do? Try to guess what the loop does, and then create and run a script to confirm your intuition.</p>
<pre class="r"><code>z &lt;- seq(1, 100, by = 3)
for (k in z) {
   if (k / 4 &lt; 10) {
    print(k)
  }
}</code></pre>
<p>Last but not least, <code>ifelse</code>-constructs allows us to make to the execution of commands conditional. The function <code>ifelse(test, yes, no)</code> contains a logical <code>test</code>, and <code>yes</code> and <code>no</code> are output conditional of whether the logical test results in <code>TRUE</code> or <code>FALSE</code>.</p>
<pre class="r"><code>x &lt;- 2
ifelse (x &gt; 0, &quot;positive&quot;, &quot;negative, 0&quot;)</code></pre>
<p>If we want to incorporate more than one logical test we can use <code>if</code> and <code>else</code> as in the following example:</p>
<pre class="r"><code>x &lt;- 0
if (x &lt; 0) {print(&quot;Negative number&quot;)} else
    if (x &gt; 0) {print(&quot;Positive number&quot;)} else
      print(&quot;Zero&quot;)</code></pre>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>So far, we have used many built-in functions (e.g., <code>length</code>, <code>dim</code>, <code>log</code>, <code>sum</code>, etc.). What makes R powerful is the ability to define your own functions and invoke them within your programs. These are called <em>user-defined functions</em>.</p>
<p>Here is the general anatomy of a function:</p>
<pre><code>my_func_name &lt;- function([optional arguments]) {
  operations
  return(value) [optional]
}</code></pre>
<p>For instance,</p>
<pre class="r"><code>circle_surface &lt;- function(radius) {
  pi * radius^2
}</code></pre>
<p>defines a function called <code>circlesurface</code> which takes as input argument a variable called <code>radius</code> and returns the value <code>pi*radius^2</code> (here <code>pi</code> is the constant <span class="math inline">\(\pi=3.14\ldots\)</span>), which is indeed the formula for the surface area of a surface. The code of the function is contained between the curly brackets. At the end, a value may be returned.</p>
<p>After submitting the function to R, we can <em>call</em> this function to calculate the surface of circles with given radius.</p>
<pre class="r"><code>circle_surface(2)
# apply the function to a vector of radii
circle_surface(1:5)</code></pre>
<p>Some functions may have more than one argument and may return more than one value:</p>
<pre class="r"><code>rectangle &lt;- function(side_1, side_2){
  circumference &lt;- 2 * side_1 + 2 * side_2
  surface &lt;- side_1 * side_2
  return(list(circumference = circumference, surface = surface))
}

rectangle(2, 3)</code></pre>
<p>Here, the output of the function is presented in a named list.</p>
<p>It is often useful to eplore functions by plotting them (see next section):</p>
<pre class="r"><code>curve(circle_surface(x), from = 0, to = 2, xlab = &quot;radius&quot;,  ylab = &quot;circle surface&quot;)
curve(rectangle(x, side_2 = 2)$surface, from = 0, to = 2, xlab = &quot;side_1&quot;, ylab = &quot;rectangle surface&quot;)</code></pre>
<p>Functions can be arbitrarily complicated and most simulation models will have a more or less complex function at its heart. For instance, we can incorporate <code>loops</code> and <code>iflese</code>-constructs into functions.</p>
<pre class="r"><code>sign_of_a_number &lt;- function(x){
  if (x &lt; 0) {print(&quot;Negative number&quot;)} else
    if (x &gt; 0) {print(&quot;Positive number&quot;)} else
      print(&quot;Zero&quot;)
}

sign_of_a_number(2.3)</code></pre>
<p>What do you think is the following function computing?</p>
<pre class="r"><code>my_factorial &lt;- function(n){
  result &lt;- 1
  i &lt;- 1
  while (i &lt;=  n){
    result &lt;- result * i
    i &lt;- i + 1
  }
  result
}

my_factorial(4)</code></pre>
</div>
<div id="random-numbers" class="section level2">
<h2>Random Numbers</h2>
<p>R can sample (pseudo)random numbers from many distributions. This is very useful for simulations! For example,</p>
<pre class="r"><code>&gt; runif(3) # samples three numbers from uniform distribution over the interval (0, 1)
&gt; runif(10, -1, 1) # samples ten numbers from uniform distribution over the interval (-1, 1)
&gt; # samples four values from normal distribution with mean 1 and standard deviation 5
&gt; rnorm(4, mean = 1, sd = 5)
&gt; # draws five values from Poisson distribution with mean lambda
&gt; rpois(5, lambda = 5)</code></pre>
<p>You can easily sample with or without replacement from a vector using the function <code>sample(x, size, prob, replace, ...)</code>. To get to know this function, let us simulate the outcome of throwing a dice. The possible outcomes of throwing a dice are the numbers 1 to 6. This we encode in a vector of possible outcomes: <code>possible_outcomes &lt;- c(1, 2, 3, 4, 5, 6)</code>, or, for short, <code>possible_outcomes &lt;- 1:6</code>. If the dice is <em>fair</em> each number occurs with probability 1/6. This we encode in the vector <code>probabilities &lt;- c(1/6, 1/6, 1/6, 1/6, 1/6, 1/6)</code>, or, for short, <code>probabilities &lt;- rep(1/6, 6)</code>. Since the outcome of any particular throw is independent of all previous throws we <em>sample without replacement</em>. We have to specify this in the function <code>sample</code> by adding <code>replace = TRUE</code>. Finally, we have to add how often we throw the dice by specifying a value for <code>size</code>, for example, <code>size = 1</code> if we throw the dice only once.</p>
<pre class="r"><code>possible_outcomes &lt;- 1:6
probabilities &lt;- rep(1/6, 6)

sample(x = possible_outcomes, size = 1, prob = probabilities &lt;- rep(1/6, 6), replace = TRUE)

sample(possible_outcomes, 10, probabilities &lt;- rep(1/6, 6), replace = TRUE) # simulating the outcome of ten throws</code></pre>
<p>Can you code a function that simulates the sum of the eyes when throwing two dice together?</p>
<pre class="r"><code>two_dice_sum &lt;- function() {
  outcome &lt;- sample(x = possible_outcomes, size = 2, prob = probabilities &lt;- rep(1/6, 6), replace = TRUE)
  sum(outcome)
}

two_dice_sum()</code></pre>
<div id="exercises-1" class="section level4">
<h4>Exercises</h4>
<ol style="list-style-type: lower-alpha">
<li>Can you write a function that gives the frequency for the different outcomes of throwing a dise as a function <code>size</code>, that is, the number of times a dice is thrown. Present the results in a histogram. How do the results change if you increase <code>size</code>?</li>
<li>Do the same for the sum of the eyes when throwing two dice simultaneously. Thus, here the question is how the distribution of this sum changes when we increase the number of times we throw two dice together?</li>
</ol>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
